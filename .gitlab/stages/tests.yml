unit-tests:
  stage: tests

  script:
    - echo "Unit tests started"
    - "mvn surefire:test"
#    - "mvn jacoco:report-aggregate"
#    - "cat reports/jacoco/index.html | grep -Po 'Total.*?([0-9]{1,3})%'"

#  coverage: /Total.*?([0-9]{1,3})%/


integration-tests:
  stage: tests

  script:
    - echo "Integration tests started"
    - "mvn failsafe:integration-test"
#    - "mvn jacoco:report-aggregate"
#    - "cat reports/jacoco/index.html | grep -Po 'Total.*?([0-9]{1,3})%'"

#  coverage: /Total.*?([0-9]{1,3})%/


mutation-tests-core:
  stage: tests
  allow_failure: true
  script:
    - echo "Mutation tests core started"
    - "mvn -pl core pitest:mutationCoverage"
    - "mvn -pl core pitest:report-aggregate"
#    - "cat reports/pitest/index | grep todo something"

#  coverage: /Total.*?([0-9]{1,3})%/

mutation-tests-adapter-spark:
  stage: tests
  allow_failure: true
  script:
    - echo "Mutation tests adapter/spark started"
    - "mvn -pl adapter/spark pitest:report-aggregate"
#    - "cat reports/pitest/index | grep todo something"

#  coverage: /Total.*?([0-9]{1,3})%/
